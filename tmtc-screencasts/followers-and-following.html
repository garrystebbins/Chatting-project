---
layout: layouts/post.njk
title: >
      Followers and Following
date: 2011-12-03 06:48:16
episode_number: 
duration: 
audio_url: 
tags: tmtc-screencasts
---

<object width="560" height="315" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="src" value="http://www.youtube.com/v/SCTxn5VXTg8?version=3&amp;hl=en_US" /><param name="allowfullscreen" value="true" /><embed width="560" height="315" type="application/x-shockwave-flash" src="http://www.youtube.com/v/SCTxn5VXTg8?version=3&amp;hl=en_US" allowFullScreen="true" allowscriptaccess="always" allowfullscreen="true" /></object>

In order to get someone a timeline in JotRod, we need followers and following lists to compile the Jots from. This means that we need to add a new ColumnFamily called Followers and another one called Following. We don't have the joins capability from relational databases to do this for us.

I'm going to hijack the User model's database connection to create the ColumnFamilies. (We don't have migrations, yet.) Here's what I ran in the rails console:
<pre>cf_def = CassandraThrift::CfDef.new(:keyspace =&gt; "JotRod", :name =&gt; "Followers")
User.connection.add_column_family(cf_def)
cf_def = CassandraThrift::CfDef.new(:keyspace =&gt; "JotRod", :name =&gt; "Following")
User.connection.add_column_family(cf_def)</pre>
Now that we have the ColumnFamilies, I want to have syntax like this to define the relationships on the User model:
<pre>list :followers, :User
list :following, :User</pre>
This should provide the following API:

#followers - returns an array of users as specified from the Followers ColumnFamily
#followers&lt;&lt;(user) Â - adds the user to the User object's followers list if it's not already there

and a similar API for following.

<a href="https://github.com/charlesmaxwood/sandra">Sandra's repository</a>

<a href="https://github.com/charlesmaxwood/jotrod">JotRod's repository</a>

<a href="http://traffic.libsyn.com/tmtc/FollowersAndFollowing-720.mov">Download</a> 680 MB
<a href="http://traffic.libsyn.com/tmtc/FollowersAndFollowing-iPhone.m4v">Download (iPod &amp; iPhone)</a> 165 MB
<a href="http://teachmetocode.com/survey">Take the 2011 Readers Survey</a>

<h3>Transcript</h3>


